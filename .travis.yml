language: go

go:
  - 1.6
  - 1.7
  - 1.8
  - tip

os:
  - linux
  - osx

sudo: false

services:
  - redis-server

before_install:
  # TRAVIS_OS_NAME - linux and osx
  - 'if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update && brew install memcached redis; fi'
  - 'if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then nohup /usr/local/opt/memcached/bin/memcached & fi'
  - 'if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then nohup redis-server /usr/local/etc/redis.conf & fi'

install:
  # Setting environments variables
  - export PATH=$PATH:$HOME/gopath/bin
  - export REVEL_BRANCH="develop"
  - 'if [[ "$TRAVIS_BRANCH" == "master" ]]; then export REVEL_BRANCH="master"; fi'
  - 'echo "Travis branch: $TRAVIS_BRANCH, Revel dependency branch: $REVEL_BRANCH"'
  - go get -v github.com/yangfei4913438/redis-full

script:
  - go test -v github.com/yangfei4913438/redis-full

matrix:
  allow_failures:
    - go: tip
